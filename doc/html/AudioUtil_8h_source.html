<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>WaveformWidget: AudioUtil.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
    </ul>
  </div>
<h1>AudioUtil.h</h1><a href="AudioUtil_8h.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#ifndef AUDIOUTIL_H</span>
<a name="l00002"></a>00002 <span class="preprocessor"></span><span class="preprocessor">#define AUDIOUTIL_H</span>
<a name="l00003"></a>00003 <span class="preprocessor"></span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;sndfile.h&gt;</span>
<a name="l00005"></a>00005 
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00007"></a>00007 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;string&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;vector&gt;</span>
<a name="l00012"></a>00012 <span class="comment"></span>
<a name="l00013"></a>00013 <span class="comment">/*!</span>
<a name="l00014"></a>00014 <span class="comment">    \file AudioUtil.h</span>
<a name="l00015"></a>00015 <span class="comment">    \brief AudioUtil header file</span>
<a name="l00016"></a>00016 <span class="comment"> */</span>
<a name="l00017"></a>00017 
<a name="l00018"></a>00018 <span class="preprocessor">#define MAX_CHANNELS 2</span>
<a name="l00019"></a>00019 <span class="preprocessor"></span>
<a name="l00020"></a>00020 <span class="keyword">using namespace </span>std;
<a name="l00021"></a>00021 <span class="comment"></span>
<a name="l00022"></a>00022 <span class="comment">/*!</span>
<a name="l00023"></a>00023 <span class="comment">\brief Provides a number of utilities for pulling useful data from audio files.</span>
<a name="l00024"></a>00024 <span class="comment"></span>
<a name="l00025"></a>00025 <span class="comment">This class began as a nice, object-oriented wrapper for certain functions that I found myself frequently using in Erik de Castro Lopo&apos;s &lt;a href=&quot;http://www.mega-nerd.com/libsndfile/&quot;&gt;libsndfile&lt;/a&gt;.  It now supports an optional caching scheme (enabled by calling setFileHandlingMode(AudioUtil::FULL_CACHE) on an instance of AudioUtil)  to dramatically speed up the performance of certain functions, like that for accessing arbitrary frames (grabFrame()) of an audio file and that for determining the peak value for a given region of an audio file (peakForRegion()).</span>
<a name="l00026"></a>00026 <span class="comment">*/</span>
<a name="l00027"></a><a class="code" href="classAudioUtil.html">00027</a> <span class="keyword">class </span><a class="code" href="classAudioUtil.html" title="Provides a number of utilities for pulling useful data from audio files.">AudioUtil</a>
<a name="l00028"></a>00028 {
<a name="l00029"></a>00029 
<a name="l00030"></a>00030 <span class="keyword">public</span>:
<a name="l00031"></a>00031         <a class="code" href="classAudioUtil.html#a6d030f910af2f43c606be1bee03ed18e" title="Default constructor.">AudioUtil</a>();
<a name="l00032"></a>00032         <a class="code" href="classAudioUtil.html#a6d030f910af2f43c606be1bee03ed18e" title="Default constructor.">AudioUtil</a>(<span class="keywordtype">string</span> filePath);
<a name="l00033"></a>00033         ~<a class="code" href="classAudioUtil.html" title="Provides a number of utilities for pulling useful data from audio files.">AudioUtil</a>();
<a name="l00034"></a>00034         <span class="keywordtype">bool</span> <a class="code" href="classAudioUtil.html#a5f477f4385a0da16f930d627dc168723" title="Sets the file to be wrapped by an instance of AudioUtil.">setFile</a>(<span class="keywordtype">string</span> filePath);
<a name="l00035"></a>00035         <span class="keywordtype">int</span> <a class="code" href="classAudioUtil.html#ab426f4ff941e0e7eeb68c2c1eb0cb333" title="The number of channels of the wrapped audio file.">getNumChannels</a>();
<a name="l00036"></a>00036         <span class="keywordtype">int</span> <a class="code" href="classAudioUtil.html#afd587ae3381e94d76e826e76d2a38378" title="The sample rate of the wrapped audio file.">getSampleRate</a>();
<a name="l00037"></a>00037         <span class="keywordtype">int</span> <a class="code" href="classAudioUtil.html#ad4d581baa08a44c7c5d2ee05f589dcf1" title="The total number of frames of the wrapped audio file.">getTotalFrames</a>();
<a name="l00038"></a>00038         vector&lt;double&gt; <a class="code" href="classAudioUtil.html#a13513ca40750bfc2c71e269e1826fadc" title="Calculates peak values for the normalized audio data of the audio file wrapped by...">calculateNormalizedPeaks</a>();
<a name="l00039"></a>00039         vector&lt;double&gt; <a class="code" href="classAudioUtil.html#a6aa717262c503b4c6b238fdebdc1d1ca" title="Get a given frame of the wrapped audio file.">grabFrame</a>(<span class="keywordtype">int</span> frameIndex);
<a name="l00040"></a>00040         vector&lt;double&gt; <a class="code" href="classAudioUtil.html#ac32f8bd852e56ada63ea24fa666c08db" title="Peak for a given region of the wrapped audio file.">peakForRegion</a>(<span class="keywordtype">int</span> region_start_frame, <span class="keywordtype">int</span> region_end_frame);
<a name="l00041"></a>00041         vector&lt;double&gt; <a class="code" href="classAudioUtil.html#a6cd1c1137a4ab43565ea6275e5dc0eb4" title="The content of the wrapped audio file.">getAllFrames</a>();
<a name="l00042"></a>00042         <span class="keyword">enum</span> FileHandlingMode {FULL_CACHE, DISK_MODE};
<a name="l00043"></a>00043         FileHandlingMode <a class="code" href="classAudioUtil.html#af2e6ba95a82a2a28cb880247e22b9e64" title="Accessor for an instance of AudioUtil&amp;#39;s file-handling mode.">getFileHandlingMode</a>();
<a name="l00044"></a>00044         <span class="keywordtype">void</span> <a class="code" href="classAudioUtil.html#aa6e29dfd59fb16462f5ee00ce7c311db" title="The mutator for the file-handling mode of an instance of AudioUtil.">setFileHandlingMode</a>(FileHandlingMode mode);
<a name="l00045"></a>00045 
<a name="l00046"></a>00046 <span class="keyword">private</span>:
<a name="l00047"></a>00047         <span class="keywordtype">double</span> data [MAX_CHANNELS];
<a name="l00048"></a>00048         FileHandlingMode fileHandlingMode;
<a name="l00049"></a>00049         <span class="keywordtype">string</span> srcFilePath;
<a name="l00050"></a>00050         SNDFILE *sndFile;
<a name="l00051"></a>00051         SF_INFO *sfinfo;
<a name="l00052"></a>00052         <span class="keywordtype">bool</span> sndFileNotEmpty;
<a name="l00053"></a>00053         vector&lt;double&gt; peaks;
<a name="l00054"></a>00054         vector&lt;double&gt; regionPeak;
<a name="l00055"></a>00055         vector&lt;double&gt; fileCache;
<a name="l00056"></a>00056         <span class="keywordtype">int</span> readcount;
<a name="l00057"></a>00057         vector&lt;double&gt; dataVector;
<a name="l00058"></a>00058         <span class="keywordtype">void</span> populateCache();
<a name="l00059"></a>00059 
<a name="l00060"></a>00060 };
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 <span class="preprocessor">#endif // AUDIOUTIL_H</span>
</pre></div></div>
<hr size="1"/><address style="text-align: right;"><small>Generated on Fri Jun 11 02:38:46 2010 for WaveformWidget by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
